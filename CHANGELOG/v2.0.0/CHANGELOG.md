v2.0 - Koharu（小鸟游星野） release 1

## 🚀 主要更新

- 新增 **获取星期几功能**，新增 `_get_current_day_of_week()` 函数用于获取当前是星期几
- 新增 **按星期几获取上课时间段功能**，新增 `get_class_times_by_day()` 和 `get_class_times_by_day_with_week()` 方法，支持按星期几和周数（单数/双数）获取上课时间段
- 新增 **智能拖动识别系统**，实现基于时间和距离的多因素拖动检测算法

## 💡 功能优化

- 优化 **时间判断逻辑**，重构 `_is_non_class_time()` 函数，改为直接判断当前时间是否在上课时间段内，不在则返回非上课时间
- 优化 **CSES解析器代码结构**，重新排序方法组织，将公共方法按功能分组，私有方法统一放在文件末尾
- 优化 **时间段排序逻辑**，新增 `_sort_timeslots_by_time()` 方法，消除3处重复代码
- 优化 **科目-老师映射构建**，新增 `_build_subject_teacher_map()` 方法，消除2处重复代码
- 优化 **类型提示统一性**，统一使用 `str | int` 格式替代 `Union[str, int]`
- 优化 **extract.py代码结构**，调整导入顺序为"标准库→第三方库→本地模块"，按功能分组函数
- 优化 **CSES解析器获取逻辑**，新增 `_get_cses_parser()` 方法，消除3处重复的解析器创建代码
- 优化 **非上课时间段获取**，简化 `_get_non_class_times_config()` 和 `_get_class_times_by_day()` 方法
- 优化 **返回类型提示**，统一导入函数返回类型为 `Tuple[bool, str]`
- 优化 **拖动设置持久化**，修复**浮动窗口拖动开关**在应用重启后不生效的问题
- 优化 **长按时间设置**，修复**长按持续时间设置**不生效的问题
- 优化 **布尔值设置读取**，修正设置值为false时返回默认值的问题
- 优化 **拖动灵敏度**，将基础拖动阈值从3px提高到8px，添加50ms最小拖动时间要求

## 🐛 修复问题

- 修复 **主窗口大小保存功能**，修复主窗口大小无法正确保存和恢复的问题，确保窗口大小在程序关闭和重启后能够正确恢复
- 修复 **侧边栏显示控制**，修复侧边栏设置中的"不显示"选项无效问题，现在当用户选择"不显示"时对应的功能项将不会出现在导航栏中
- 修复 **课间禁用功能失效问题**，修复由于**时间段排序错误**、**星期几分组错误**和**时间解析失败**导致的课间禁用功能无法正常工作的问题
- 修复 **时间段排序问题**，修复按字符串排序导致的时间顺序错误，改为按实际时间值（秒数）排序
- 修复 **整数时间解析问题**，修复 `_parse_time_string_to_seconds()` 方法无法处理整数秒数的问题，支持字符串和整数两种格式
- 修复 **异步函数调用问题**，修复 `readme_settings_async` 导致的 coroutine 对象问题，改为同步调用 `readme_settings`
- 修复 **模块导入位置问题**，修复 `import os` 语句位置不当导致的变量访问错误
- 修复 **星期几分组问题**，修复不同星期几的课程时间被错误混合计算的问题，为每一天单独生成时间段
- 修复 **shutil导入位置问题**，将 `shutil` 导入移至函数内部，避免全局导入
- 修复 **点名人数统计功能**，新增过滤标记为"不存在"的学生，确保剩余人数显示准确
- 修复 **抽奖奖品数量统计功能**，新增过滤标记为"不存在"的奖品，确保剩余奖品数量显示准确
- 修复 **剩余名单显示功能**，新增过滤标记为"不存在"的学生/奖品，确保剩余名单不包含已标记为不存在的人员
- 修复 **拖动权限控制**，解决即使禁用拖动功能仍然可以拖动窗口的问题
- 修复 **点击与拖动区分**，解决按钮点击容易被误识别为拖动操作的问题
- 修复 **嵌套组件权限继承**，修复DraggableWidget组件未正确继承主窗口拖动权限的问题
- 修复 **收纳浮窗文本颜色**，暗色/浅色主题下的文本颜色显示问题
- 修复 **收纳浮窗透明度计算**，透明度值范围错误问题
- 修复 **收纳浮窗背景色**，浅色主题背景色过亮问题
- 修复 **收纳浮窗CSS样式冲突**，transparent与background-color样式冲突
- 修复 **收纳浮窗圆角效果**，圆角显示不明显问题
- 修复 **名单管理界面**，优化UI组件操作的安全性，避免"Internal C++ object already deleted"错误
- 优化 **班级列表刷新功能**，为每个UI操作添加独立异常处理，确保对象删除时不会崩溃
- 优化 **奖池列表刷新功能**，为每个UI操作添加独立异常处理，确保对象删除时不会崩溃
- 修复 **按钮状态更新**，为每个按钮操作添加独立异常处理，防止因单个按钮删除导致整个方法失败
- 优化 **文件监视器响应机制**，确保在UI组件销毁后仍能安全处理文件变化事件

## 🔧 其它变更

- 无

---

💝 **感谢所有贡献者为 SecRandom 项目付出的努力！**

<!--
在更新此CHANGELOG.md文件时，请遵循以下格式：
- 使用"新增/优化/修复" + "功能名称" + "更新内容"的格式
- 示例："新增 更新通知弹窗，新增"今日不再提醒"功能"
- 示例："优化 课间禁用功能，新增在点名、抽奖的"开始"按钮点击后显示禁用状态提示"
- 示例："修复 DPI缩放问题，新增修复界面字体大小异常和界面比例失调问题"
- 注意：保持文本内容简洁明了，避免冗余描述
- 注意：适当加粗部分内容，如功能名称、关键特性等，使用**加粗文本**格式
保持格式一致性，确保每个更新条目都遵循这一模式。
-->
